{
    "contents" : "\n\nlibrary(ggbio)\nlibrary(GenomicRanges)\n\necoli_genome_length = 4641652\necoli_df <- read.table(\"data/genomic_ranges/NC_000913.3_CDS_gr.txt\", sep=\"\\t\", header=T, quote = \"\")\necoli_gr <- makeGRangesFromDataFrame(ecoli_df, keep.extra.columns=T)\nseqlengths(ecoli_gr) <- ecoli_genome_length\n\ndups_df <- read.table(\"sim2_dup_60.txt\", sep=\"\\t\", header=T, quote=\"\")\n\n# calculate double count proportion\ndbl_count_table <- table(dups_df$dbl_count)\ndouble_count_percent <- dbl_count_table[\"TRUE\"] * 100 / (dbl_count_table[\"TRUE\"] + dbl_count_table[\"FALSE\"])\n\n# subsample for plotting\nset.seed(31456)\nsample_rows <- sample(1:nrow(dups_df), nrow(dups_df)*0.25, replace = F)\n\n# prepare\ncolors = rep(\"blue\", length(dups_df$dbl_count))\ncolors[dups_df$dbl_count == TRUE] = \"red\"\ndups_df$colors = colors\n\ndedup = rep(\"blue\", length(dups_df$dbl_count))\ndedup[dups_df$sofa == TRUE] = \"pink\"\ndups_df$dedup = dedup\n\ndups_df_small = data.frame(chr=dups_df$chr[sample_rows],\n           start=dups_df$start[sample_rows],\n           end=dups_df$end[sample_rows],\n           strand=dups_df$strand[sample_rows],\n           dbl_count=dups_df$dbl_count[sample_rows],\n           colors=dups_df$colors[sample_rows],\n           sofa=dups_df$dedup[sample_rows])\n\ndups_gr_small <- makeGRangesFromDataFrame(dups_df_small, keep.extra.columns=T)\nseqlengths(dups_gr_small) <- ecoli_genome_length\n\np1 <- ggbio()\np1 <- p1 + circle(subset(dups_gr_small, sofa==\"pink\"), geom = \"rect\", color=\"purple\")\np1 <- p1 + circle(subset(dups_gr_small, colors==\"red\"), geom = \"rect\", color=\"red\") \np1 <- p1 + circle(subset(dups_gr_small, colors==\"blue\"), geom = \"rect\", color=\"blue\") \n\n\np1 <- p1 + circle(ecoli_gr, geom = \"rect\", color = \"#7EC658\")\np1 <- p1 + circle(ecoli_gr, geom = \"ideo\", fill = \"gray70\") \np1 <- p1 + circle(ecoli_gr, geom = \"scale\", scale.n=10, size = 3)\np1\n\necoli_coding_percent <- round(sum(abs(ecoli_df$end - ecoli_df$start)) * 100 / ecoli_genome_length, 1)\necoli_avg_gene_length <- round(sum(abs(ecoli_df$end - ecoli_df$start)) / length(ecoli_df$start))\nsum(abs(dups_df$start-dups_df$end)) / length(dups_df$star)\n\n",
    "created" : 1427846683552.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3140789103",
    "id" : "4F00BC22",
    "lastKnownWriteTime" : 1427850163,
    "path" : "~/SOFA/r_analysis/SOFA_r_analysis_kk_ah.Rmd",
    "project_path" : "SOFA_r_analysis_kk_ah.Rmd",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}
{
    "contents" : "---\ntitle: \"SOFA E.coli Simulation\"\nauthor: \"Niels Hanson\"\ndate: \"March 28, 2015\"\noutput:\n  html_document:\n    fig_caption: yes\n    keep_md: yes\n    number_sections: yes\n    toc: yes\n---\n\n# Preample\n\n* Load required libraries\n\n```{r message=FALSE, warning=FALSE, error=FALSE}\nlibrary(ggbio)\nlibrary(GenomicRanges)\n```\n\n# E. coli Paired-end Simulation\n\n* Load CDS genomic ranges for E. coli\n\n```{r}\necoli_genome_length = 4641652\necoli_df <- read.table(\"data/genomic_ranges/NC_000913.3_CDS_gr.txt\", sep=\"\\t\", header=T, quote = \"\")\necoli_gr <- makeGRangesFromDataFrame(ecoli_df, keep.extra.columns=T)\nseqlengths(ecoli_gr) <- ecoli_genome_length\n```\n\n* Load duplication ranges:\n    * calculate double-count proportion\n\n```{r}\ndups_df <- read.table(\"data/genomic_ranges/EcoliSim2_dups_gr.txt\", sep=\"\\t\", header=T, quote=\"\")\n\n# calculate double count proportion\ndbl_count_table <- table(dups_df$dbl_count)\ndouble_count_percent <- dbl_count_table[\"TRUE\"] * 100 / (dbl_count_table[\"TRUE\"] + dbl_count_table[\"FALSE\"])\n\n# subsample for plotting\nset.seed(31456)\nsample_rows <- sample(1:nrow(dups_df), nrow(dups_df)*0.2, replace = F)\n\n# prepare\ncolors = rep(\"blue\", length(dups_df$dbl_count))\ncolors[dups_df$dbl_count == TRUE] = \"red\"\ndups_df$colors = colors\n\ndups_df_small = data.frame(chr=dups_df$chr[sample_rows],\n           start=dups_df$start[sample_rows],\n           end=dups_df$end[sample_rows],\n           strand=dups_df$strand[sample_rows],\n           dbl_count=dups_df$dbl_count[sample_rows],\n           colors=dups_df$colors[sample_rows])\n\ndups_gr_small <- makeGRangesFromDataFrame(dups_df_small, keep.extra.columns=T)\nseqlengths(dups_gr_small) <- ecoli_genome_length\n```\n\n* Approximately `r double_count_percent` percent of paired-end reads are double-counted.\n\n* plot CDS ranges\n\n```{r }\np1 <- ggbio()\np1 <- p1 + circle(subset(dups_gr_small, colors==\"red\"), geom = \"rect\", color=\"red\")\np1 <- p1 + circle(subset(dups_gr_small, colors==\"blue\"), geom = \"rect\", color=\"blue\")\np1 <- p1 + circle(ecoli_gr, geom = \"rect\", color = \"#7EC658\")\np1 <- p1 + circle(ecoli_gr, geom = \"ideo\", fill = \"gray70\") \np1 <- p1 + circle(ecoli_gr, geom = \"scale\", scale.n=10, size = 3)\np1\n```\n\n# Theoretical Statistics of E. coli\n\n* More of a scratch section.\n\n```{r}\necoli_coding_percent <- round(sum(abs(ecoli_df$end - ecoli_df$start)) * 100 / ecoli_genome_length, 1)\necoli_avg_gene_length <- round(sum(abs(ecoli_df$end - ecoli_df$start)) / length(ecoli_df$start))\nsum(abs(dups_df$start-dups_df$end)) / length(dups_df$star)\n```\n\n* percent coding DNA: `r ecoli_coding_percent`\n* average gene length: `r ecoli_avg_gene_length`\n",
    "created" : 1427577066461.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3935146679",
    "id" : "5698DC7A",
    "lastKnownWriteTime" : 1427687991,
    "path" : "~/Dropbox/manuscripts/SOFA/r_analysis/SOFA_r_analysis.Rmd",
    "project_path" : "SOFA_r_analysis.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}
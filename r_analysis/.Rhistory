p1 <- p1 + circle(subset(dups_gr_small, colors=="blue"), geom = "rect", color="blue")
#p1 <- p1 + circle(ecoli_gr, geom = "rect", color = "#7EC658")
p1 <- p1 + circle(ecoli_gr, geom = "ideo", fill = "gray70")
p1 <- p1 + circle(ecoli_gr, geom = "scale", scale.n=10, size = 3)
p1
ecoli_coding_percent <- round(sum(abs(ecoli_df$end - ecoli_df$start)) * 100 / ecoli_genome_length, 1)
ecoli_avg_gene_length <- round(sum(abs(ecoli_df$end - ecoli_df$start)) / length(ecoli_df$start))
sum(abs(dups_df$start-dups_df$end)) / length(dups_df$star)
library(ggbio)
library(GenomicRanges)
ecoli_genome_length = 4641652
ecoli_df <- read.table("data/genomic_ranges/NC_000913.3_CDS_gr.txt", sep="\t", header=T, quote = "")
ecoli_gr <- makeGRangesFromDataFrame(ecoli_df, keep.extra.columns=T)
seqlengths(ecoli_gr) <- ecoli_genome_length
dups_df <- read.table("sim2_dup_60.txt", sep="\t", header=T, quote="")
# calculate double count proportion
dbl_count_table <- table(dups_df$dbl_count)
double_count_percent <- dbl_count_table["TRUE"] * 100 / (dbl_count_table["TRUE"] + dbl_count_table["FALSE"])
# subsample for plotting
set.seed(31456)
sample_rows <- sample(1:nrow(dups_df), nrow(dups_df)*0.01, replace = F)
# prepare
colors = rep("blue", length(dups_df$dbl_count))
colors[dups_df$dbl_count == TRUE] = "red"
colors[dups_df$sofa == TRUE] = "pink"
dups_df$colors = colors
dups_df_small = data.frame(chr=dups_df$chr[sample_rows],
start=dups_df$start[sample_rows],
end=dups_df$end[sample_rows],
strand=dups_df$strand[sample_rows],
dbl_count=dups_df$dbl_count[sample_rows],
colors=dups_df$colors[sample_rows])
dups_gr_small <- makeGRangesFromDataFrame(dups_df_small, keep.extra.columns=T)
seqlengths(dups_gr_small) <- ecoli_genome_length
p1 <- ggbio()
#p1 <- p1 + circle(subset(dups_gr_small, colors=="pink"), geom = "rect", color="purple")
p1 <- p1 + circle(subset(dups_gr_small, colors=="red"), geom = "rect", color="red") + circle(subset(dups_gr_small, colors=="pink"), geom = "rect", color="purple")
p1 <- p1 + circle(subset(dups_gr_small, colors=="blue"), geom = "rect", color="blue")
#p1 <- p1 + circle(ecoli_gr, geom = "rect", color = "#7EC658")
p1 <- p1 + circle(ecoli_gr, geom = "ideo", fill = "gray70")
p1 <- p1 + circle(ecoli_gr, geom = "scale", scale.n=10, size = 3)
p1
ecoli_coding_percent <- round(sum(abs(ecoli_df$end - ecoli_df$start)) * 100 / ecoli_genome_length, 1)
ecoli_avg_gene_length <- round(sum(abs(ecoli_df$end - ecoli_df$start)) / length(ecoli_df$start))
sum(abs(dups_df$start-dups_df$end)) / length(dups_df$star)
library(ggbio)
library(GenomicRanges)
ecoli_genome_length = 4641652
ecoli_df <- read.table("data/genomic_ranges/NC_000913.3_CDS_gr.txt", sep="\t", header=T, quote = "")
ecoli_gr <- makeGRangesFromDataFrame(ecoli_df, keep.extra.columns=T)
seqlengths(ecoli_gr) <- ecoli_genome_length
dups_df <- read.table("sim2_dup_60.txt", sep="\t", header=T, quote="")
# calculate double count proportion
dbl_count_table <- table(dups_df$dbl_count)
double_count_percent <- dbl_count_table["TRUE"] * 100 / (dbl_count_table["TRUE"] + dbl_count_table["FALSE"])
# subsample for plotting
set.seed(31456)
sample_rows <- sample(1:nrow(dups_df), nrow(dups_df)*0.01, replace = F)
# prepare
colors = rep("blue", length(dups_df$dbl_count))
colors[dups_df$dbl_count == TRUE] = "red"
colors[dups_df$sofa == TRUE] = "pink"
dups_df$colors = colors
dups_df_small = data.frame(chr=dups_df$chr[sample_rows],
start=dups_df$start[sample_rows],
end=dups_df$end[sample_rows],
strand=dups_df$strand[sample_rows],
dbl_count=dups_df$dbl_count[sample_rows],
colors=dups_df$colors[sample_rows])
dups_gr_small <- makeGRangesFromDataFrame(dups_df_small, keep.extra.columns=T)
seqlengths(dups_gr_small) <- ecoli_genome_length
p1 <- ggbio()
#p1 <- p1 + circle(subset(dups_gr_small, colors=="pink"), geom = "rect", color="purple")
p1 <- p1 + circle(subset(dups_gr_small, colors=="red"), geom = "rect", color="red")
p1 <- p1 + circle(subset(dups_gr_small, colors=="blue"), geom = "rect", color="blue")
#p1 <- p1 + circle(ecoli_gr, geom = "rect", color = "#7EC658")
p1 <- p1 + circle(ecoli_gr, geom = "ideo", fill = "gray70")
p1 <- p1 + circle(ecoli_gr, geom = "scale", scale.n=10, size = 3)
p1
ecoli_coding_percent <- round(sum(abs(ecoli_df$end - ecoli_df$start)) * 100 / ecoli_genome_length, 1)
ecoli_avg_gene_length <- round(sum(abs(ecoli_df$end - ecoli_df$start)) / length(ecoli_df$start))
sum(abs(dups_df$start-dups_df$end)) / length(dups_df$star)
library(ggbio)
library(GenomicRanges)
ecoli_genome_length = 4641652
ecoli_df <- read.table("data/genomic_ranges/NC_000913.3_CDS_gr.txt", sep="\t", header=T, quote = "")
ecoli_gr <- makeGRangesFromDataFrame(ecoli_df, keep.extra.columns=T)
seqlengths(ecoli_gr) <- ecoli_genome_length
dups_df <- read.table("sim2_dup_60.txt", sep="\t", header=T, quote="")
# calculate double count proportion
dbl_count_table <- table(dups_df$dbl_count)
double_count_percent <- dbl_count_table["TRUE"] * 100 / (dbl_count_table["TRUE"] + dbl_count_table["FALSE"])
# subsample for plotting
set.seed(31456)
sample_rows <- sample(1:nrow(dups_df), nrow(dups_df)*0.01, replace = F)
# prepare
colors = rep("blue", length(dups_df$dbl_count))
colors[dups_df$dbl_count == TRUE] = "red"
colors[dups_df$sofa == TRUE] = "pink"
dups_df$colors = colors
dups_df_small = data.frame(chr=dups_df$chr[sample_rows],
start=dups_df$start[sample_rows],
end=dups_df$end[sample_rows],
strand=dups_df$strand[sample_rows],
dbl_count=dups_df$dbl_count[sample_rows],
colors=dups_df$colors[sample_rows])
dups_gr_small <- makeGRangesFromDataFrame(dups_df_small, keep.extra.columns=T)
seqlengths(dups_gr_small) <- ecoli_genome_length
p1 <- ggbio()
p1 <- p1 + circle(subset(dups_gr_small, colors=="red"), geom = "rect", color="red")
p1 <- p1 + circle(subset(dups_gr_small, colors=="blue"), geom = "rect", color="blue")
p1 <- p1 + circle(subset(dups_gr_small, colors=="pink"), geom = "rect", color="purple")
#p1 <- p1 + circle(ecoli_gr, geom = "rect", color = "#7EC658")
p1 <- p1 + circle(ecoli_gr, geom = "ideo", fill = "gray70")
p1 <- p1 + circle(ecoli_gr, geom = "scale", scale.n=10, size = 3)
p1
ecoli_coding_percent <- round(sum(abs(ecoli_df$end - ecoli_df$start)) * 100 / ecoli_genome_length, 1)
ecoli_avg_gene_length <- round(sum(abs(ecoli_df$end - ecoli_df$start)) / length(ecoli_df$start))
sum(abs(dups_df$start-dups_df$end)) / length(dups_df$star)
library(ggbio)
library(GenomicRanges)
ecoli_genome_length = 4641652
ecoli_df <- read.table("data/genomic_ranges/NC_000913.3_CDS_gr.txt", sep="\t", header=T, quote = "")
ecoli_gr <- makeGRangesFromDataFrame(ecoli_df, keep.extra.columns=T)
seqlengths(ecoli_gr) <- ecoli_genome_length
dups_df <- read.table("sim2_dup_60.txt", sep="\t", header=T, quote="")
# calculate double count proportion
dbl_count_table <- table(dups_df$dbl_count)
double_count_percent <- dbl_count_table["TRUE"] * 100 / (dbl_count_table["TRUE"] + dbl_count_table["FALSE"])
# subsample for plotting
set.seed(31456)
sample_rows <- sample(1:nrow(dups_df), nrow(dups_df)*0.01, replace = F)
# prepare
colors = rep("blue", length(dups_df$dbl_count))
colors[dups_df$dbl_count == TRUE] = "red"
colors[dups_df$sofa == TRUE] = "pink"
dups_df$colors = colors
dups_df_small = data.frame(chr=dups_df$chr[sample_rows],
start=dups_df$start[sample_rows],
end=dups_df$end[sample_rows],
strand=dups_df$strand[sample_rows],
dbl_count=dups_df$dbl_count[sample_rows],
colors=dups_df$colors[sample_rows])
dups_gr_small <- makeGRangesFromDataFrame(dups_df_small, keep.extra.columns=T)
seqlengths(dups_gr_small) <- ecoli_genome_length
p1 <- ggbio()
p1 <- p1 + circle(subset(dups_gr_small, colors=="pink"), geom = "rect", color="purple")
p1 <- p1 + circle(subset(dups_gr_small, colors=="red"), geom = "rect", color="red")
p1 <- p1 + circle(subset(dups_gr_small, colors=="blue"), geom = "rect", color="blue")
#p1 <- p1 + circle(ecoli_gr, geom = "rect", color = "#7EC658")
p1 <- p1 + circle(ecoli_gr, geom = "ideo", fill = "gray70")
p1 <- p1 + circle(ecoli_gr, geom = "scale", scale.n=10, size = 3)
p1
ecoli_coding_percent <- round(sum(abs(ecoli_df$end - ecoli_df$start)) * 100 / ecoli_genome_length, 1)
ecoli_avg_gene_length <- round(sum(abs(ecoli_df$end - ecoli_df$start)) / length(ecoli_df$start))
sum(abs(dups_df$start-dups_df$end)) / length(dups_df$star)
fix(sample_rows)
library(ggbio)
library(GenomicRanges)
ecoli_genome_length = 4641652
ecoli_df <- read.table("data/genomic_ranges/NC_000913.3_CDS_gr.txt", sep="\t", header=T, quote = "")
ecoli_gr <- makeGRangesFromDataFrame(ecoli_df, keep.extra.columns=T)
seqlengths(ecoli_gr) <- ecoli_genome_length
dups_df <- read.table("sim2_dup_60.txt", sep="\t", header=T, quote="")
# calculate double count proportion
dbl_count_table <- table(dups_df$dbl_count)
double_count_percent <- dbl_count_table["TRUE"] * 100 / (dbl_count_table["TRUE"] + dbl_count_table["FALSE"])
# subsample for plotting
set.seed(31456)
sample_rows <- sample(1:nrow(dups_df), nrow(dups_df)*0.01, replace = F)
# prepare
colors = rep("blue", length(dups_df$dbl_count))
colors[dups_df$dbl_count == TRUE] = "red"
testme[dups_df$sofa == TRUE] = "pink"
dups_df$colors = colors
dups_df_small = data.frame(chr=dups_df$chr[sample_rows],
start=dups_df$start[sample_rows],
end=dups_df$end[sample_rows],
strand=dups_df$strand[sample_rows],
dbl_count=dups_df$dbl_count[sample_rows],
colors=dups_df$colors[sample_rows])
sofa=dups_df$testme[sample_rows])
dups_gr_small <- makeGRangesFromDataFrame(dups_df_small, keep.extra.columns=T)
seqlengths(dups_gr_small) <- ecoli_genome_length
p1 <- ggbio()
p1 <- p1 + circle(subset(dups_gr_small, sofa=="pink"), geom = "rect", color="purple")
p1 <- p1 + circle(subset(dups_gr_small, colors=="red"), geom = "rect", color="red")
p1 <- p1 + circle(subset(dups_gr_small, colors=="blue"), geom = "rect", color="blue")
#p1 <- p1 + circle(ecoli_gr, geom = "rect", color = "#7EC658")
p1 <- p1 + circle(ecoli_gr, geom = "ideo", fill = "gray70")
p1 <- p1 + circle(ecoli_gr, geom = "scale", scale.n=10, size = 3)
p1
ecoli_coding_percent <- round(sum(abs(ecoli_df$end - ecoli_df$start)) * 100 / ecoli_genome_length, 1)
ecoli_avg_gene_length <- round(sum(abs(ecoli_df$end - ecoli_df$start)) / length(ecoli_df$start))
sum(abs(dups_df$start-dups_df$end)) / length(dups_df$star)
library(ggbio)
library(GenomicRanges)
ecoli_genome_length = 4641652
ecoli_df <- read.table("data/genomic_ranges/NC_000913.3_CDS_gr.txt", sep="\t", header=T, quote = "")
ecoli_gr <- makeGRangesFromDataFrame(ecoli_df, keep.extra.columns=T)
seqlengths(ecoli_gr) <- ecoli_genome_length
dups_df <- read.table("sim2_dup_60.txt", sep="\t", header=T, quote="")
# calculate double count proportion
dbl_count_table <- table(dups_df$dbl_count)
double_count_percent <- dbl_count_table["TRUE"] * 100 / (dbl_count_table["TRUE"] + dbl_count_table["FALSE"])
# subsample for plotting
set.seed(31456)
sample_rows <- sample(1:nrow(dups_df), nrow(dups_df)*0.01, replace = F)
# prepare
colors = rep("blue", length(dups_df$dbl_count))
colors[dups_df$dbl_count == TRUE] = "red"
testme[dups_df$sofa == TRUE] = "pink"
dups_df$colors = colors
dups_df_small = data.frame(chr=dups_df$chr[sample_rows],
start=dups_df$start[sample_rows],
end=dups_df$end[sample_rows],
strand=dups_df$strand[sample_rows],
dbl_count=dups_df$dbl_count[sample_rows],
colors=dups_df$colors[sample_rows],
sofa=dups_df$testme[sample_rows])
dups_gr_small <- makeGRangesFromDataFrame(dups_df_small, keep.extra.columns=T)
seqlengths(dups_gr_small) <- ecoli_genome_length
p1 <- ggbio()
p1 <- p1 + circle(subset(dups_gr_small, sofa=="pink"), geom = "rect", color="purple")
p1 <- p1 + circle(subset(dups_gr_small, colors=="red"), geom = "rect", color="red")
p1 <- p1 + circle(subset(dups_gr_small, colors=="blue"), geom = "rect", color="blue")
#p1 <- p1 + circle(ecoli_gr, geom = "rect", color = "#7EC658")
p1 <- p1 + circle(ecoli_gr, geom = "ideo", fill = "gray70")
p1 <- p1 + circle(ecoli_gr, geom = "scale", scale.n=10, size = 3)
p1
ecoli_coding_percent <- round(sum(abs(ecoli_df$end - ecoli_df$start)) * 100 / ecoli_genome_length, 1)
ecoli_avg_gene_length <- round(sum(abs(ecoli_df$end - ecoli_df$start)) / length(ecoli_df$start))
sum(abs(dups_df$start-dups_df$end)) / length(dups_df$star)
library(ggbio)
library(GenomicRanges)
ecoli_genome_length = 4641652
ecoli_df <- read.table("data/genomic_ranges/NC_000913.3_CDS_gr.txt", sep="\t", header=T, quote = "")
ecoli_gr <- makeGRangesFromDataFrame(ecoli_df, keep.extra.columns=T)
seqlengths(ecoli_gr) <- ecoli_genome_length
dups_df <- read.table("sim2_dup_60.txt", sep="\t", header=T, quote="")
# calculate double count proportion
dbl_count_table <- table(dups_df$dbl_count)
double_count_percent <- dbl_count_table["TRUE"] * 100 / (dbl_count_table["TRUE"] + dbl_count_table["FALSE"])
# subsample for plotting
set.seed(31456)
sample_rows <- sample(1:nrow(dups_df), nrow(dups_df)*0.01, replace = F)
# prepare
colors = rep("blue", length(dups_df$dbl_count))
colors[dups_df$dbl_count == TRUE] = "red"
dups_df$colors = colors
testme = rep("blue", length(dups_df$dbl_count))
testme[dups_df$sofa == TRUE] = "pink"
dups_df_small = data.frame(chr=dups_df$chr[sample_rows],
start=dups_df$start[sample_rows],
end=dups_df$end[sample_rows],
strand=dups_df$strand[sample_rows],
dbl_count=dups_df$dbl_count[sample_rows],
colors=dups_df$colors[sample_rows],
sofa=dups_df$testme[sample_rows])
dups_gr_small <- makeGRangesFromDataFrame(dups_df_small, keep.extra.columns=T)
seqlengths(dups_gr_small) <- ecoli_genome_length
p1 <- ggbio()
p1 <- p1 + circle(subset(dups_gr_small, sofa=="pink"), geom = "rect", color="purple")
p1 <- p1 + circle(subset(dups_gr_small, colors=="red"), geom = "rect", color="red")
p1 <- p1 + circle(subset(dups_gr_small, colors=="blue"), geom = "rect", color="blue")
#p1 <- p1 + circle(ecoli_gr, geom = "rect", color = "#7EC658")
p1 <- p1 + circle(ecoli_gr, geom = "ideo", fill = "gray70")
p1 <- p1 + circle(ecoli_gr, geom = "scale", scale.n=10, size = 3)
p1
ecoli_coding_percent <- round(sum(abs(ecoli_df$end - ecoli_df$start)) * 100 / ecoli_genome_length, 1)
ecoli_avg_gene_length <- round(sum(abs(ecoli_df$end - ecoli_df$start)) / length(ecoli_df$start))
sum(abs(dups_df$start-dups_df$end)) / length(dups_df$star)
library(ggbio)
library(GenomicRanges)
ecoli_genome_length = 4641652
ecoli_df <- read.table("data/genomic_ranges/NC_000913.3_CDS_gr.txt", sep="\t", header=T, quote = "")
ecoli_gr <- makeGRangesFromDataFrame(ecoli_df, keep.extra.columns=T)
seqlengths(ecoli_gr) <- ecoli_genome_length
dups_df <- read.table("sim2_dup_60.txt", sep="\t", header=T, quote="")
# calculate double count proportion
dbl_count_table <- table(dups_df$dbl_count)
double_count_percent <- dbl_count_table["TRUE"] * 100 / (dbl_count_table["TRUE"] + dbl_count_table["FALSE"])
# subsample for plotting
set.seed(31456)
sample_rows <- sample(1:nrow(dups_df), nrow(dups_df)*0.01, replace = F)
# prepare
colors = rep("blue", length(dups_df$dbl_count))
colors[dups_df$dbl_count == TRUE] = "red"
dups_df$colors = colors
testme = rep("blue", length(dups_df$dbl_count))
testme[dups_df$sofa == TRUE] = "pink"
dups_df$testme = testme
dups_df_small = data.frame(chr=dups_df$chr[sample_rows],
start=dups_df$start[sample_rows],
end=dups_df$end[sample_rows],
strand=dups_df$strand[sample_rows],
dbl_count=dups_df$dbl_count[sample_rows],
colors=dups_df$colors[sample_rows],
sofa=dups_df$testme[sample_rows])
dups_gr_small <- makeGRangesFromDataFrame(dups_df_small, keep.extra.columns=T)
seqlengths(dups_gr_small) <- ecoli_genome_length
p1 <- ggbio()
p1 <- p1 + circle(subset(dups_gr_small, sofa=="pink"), geom = "rect", color="purple")
p1 <- p1 + circle(subset(dups_gr_small, colors=="red"), geom = "rect", color="red")
p1 <- p1 + circle(subset(dups_gr_small, colors=="blue"), geom = "rect", color="blue")
#p1 <- p1 + circle(ecoli_gr, geom = "rect", color = "#7EC658")
p1 <- p1 + circle(ecoli_gr, geom = "ideo", fill = "gray70")
p1 <- p1 + circle(ecoli_gr, geom = "scale", scale.n=10, size = 3)
p1
ecoli_coding_percent <- round(sum(abs(ecoli_df$end - ecoli_df$start)) * 100 / ecoli_genome_length, 1)
ecoli_avg_gene_length <- round(sum(abs(ecoli_df$end - ecoli_df$start)) / length(ecoli_df$start))
sum(abs(dups_df$start-dups_df$end)) / length(dups_df$star)
library(ggbio)
library(GenomicRanges)
ecoli_genome_length = 4641652
ecoli_df <- read.table("data/genomic_ranges/NC_000913.3_CDS_gr.txt", sep="\t", header=T, quote = "")
ecoli_gr <- makeGRangesFromDataFrame(ecoli_df, keep.extra.columns=T)
seqlengths(ecoli_gr) <- ecoli_genome_length
dups_df <- read.table("sim2_dup_60.txt", sep="\t", header=T, quote="")
# calculate double count proportion
dbl_count_table <- table(dups_df$dbl_count)
double_count_percent <- dbl_count_table["TRUE"] * 100 / (dbl_count_table["TRUE"] + dbl_count_table["FALSE"])
# subsample for plotting
set.seed(31456)
sample_rows <- sample(1:nrow(dups_df), nrow(dups_df)*0.01, replace = F)
# prepare
colors = rep("blue", length(dups_df$dbl_count))
colors[dups_df$dbl_count == TRUE] = "red"
dups_df$colors = colors
dedup = rep("blue", length(dups_df$dbl_count))
dedup[dups_df$sofa == TRUE] = "pink"
dups_df$dedup = dedup
dups_df_small = data.frame(chr=dups_df$chr[sample_rows],
start=dups_df$start[sample_rows],
end=dups_df$end[sample_rows],
strand=dups_df$strand[sample_rows],
dbl_count=dups_df$dbl_count[sample_rows],
colors=dups_df$colors[sample_rows],
sofa=dups_df$dedup[sample_rows])
dups_gr_small <- makeGRangesFromDataFrame(dups_df_small, keep.extra.columns=T)
seqlengths(dups_gr_small) <- ecoli_genome_length
p1 <- ggbio()
p1 <- p1 + circle(subset(dups_gr_small, sofa=="pink"), geom = "rect", color="purple")
p1 <- p1 + circle(subset(dups_gr_small, colors=="red"), geom = "rect", color="red")
p1 <- p1 + circle(subset(dups_gr_small, colors=="blue"), geom = "rect", color="blue")
p1 <- p1 + circle(ecoli_gr, geom = "rect", color = "#7EC658")
p1 <- p1 + circle(ecoli_gr, geom = "ideo", fill = "gray70")
p1 <- p1 + circle(ecoli_gr, geom = "scale", scale.n=10, size = 3)
p1
ecoli_coding_percent <- round(sum(abs(ecoli_df$end - ecoli_df$start)) * 100 / ecoli_genome_length, 1)
ecoli_avg_gene_length <- round(sum(abs(ecoli_df$end - ecoli_df$start)) / length(ecoli_df$start))
sum(abs(dups_df$start-dups_df$end)) / length(dups_df$star)
library(ggbio)
library(GenomicRanges)
ecoli_genome_length = 4641652
ecoli_df <- read.table("data/genomic_ranges/NC_000913.3_CDS_gr.txt", sep="\t", header=T, quote = "")
ecoli_gr <- makeGRangesFromDataFrame(ecoli_df, keep.extra.columns=T)
seqlengths(ecoli_gr) <- ecoli_genome_length
dups_df <- read.table("sim2_dup_60.txt", sep="\t", header=T, quote="")
# calculate double count proportion
dbl_count_table <- table(dups_df$dbl_count)
double_count_percent <- dbl_count_table["TRUE"] * 100 / (dbl_count_table["TRUE"] + dbl_count_table["FALSE"])
# subsample for plotting
set.seed(31456)
sample_rows <- sample(1:nrow(dups_df), nrow(dups_df)*0.2, replace = F)
# prepare
colors = rep("blue", length(dups_df$dbl_count))
colors[dups_df$dbl_count == TRUE] = "red"
dups_df$colors = colors
dedup = rep("blue", length(dups_df$dbl_count))
dedup[dups_df$sofa == TRUE] = "pink"
dups_df$dedup = dedup
dups_df_small = data.frame(chr=dups_df$chr[sample_rows],
start=dups_df$start[sample_rows],
end=dups_df$end[sample_rows],
strand=dups_df$strand[sample_rows],
dbl_count=dups_df$dbl_count[sample_rows],
colors=dups_df$colors[sample_rows],
sofa=dups_df$dedup[sample_rows])
dups_gr_small <- makeGRangesFromDataFrame(dups_df_small, keep.extra.columns=T)
seqlengths(dups_gr_small) <- ecoli_genome_length
p1 <- ggbio()
p1 <- p1 + circle(subset(dups_gr_small, sofa=="pink"), geom = "rect", color="purple")
p1 <- p1 + circle(subset(dups_gr_small, colors=="red"), geom = "rect", color="red")
p1 <- p1 + circle(subset(dups_gr_small, colors=="blue"), geom = "rect", color="blue")
p1 <- p1 + circle(ecoli_gr, geom = "rect", color = "#7EC658")
p1 <- p1 + circle(ecoli_gr, geom = "ideo", fill = "gray70")
p1 <- p1 + circle(ecoli_gr, geom = "scale", scale.n=10, size = 3)
p1
ecoli_coding_percent <- round(sum(abs(ecoli_df$end - ecoli_df$start)) * 100 / ecoli_genome_length, 1)
ecoli_avg_gene_length <- round(sum(abs(ecoli_df$end - ecoli_df$start)) / length(ecoli_df$start))
sum(abs(dups_df$start-dups_df$end)) / length(dups_df$star)
library(ggbio)
library(GenomicRanges)
ecoli_genome_length = 4641652
ecoli_df <- read.table("data/genomic_ranges/NC_000913.3_CDS_gr.txt", sep="\t", header=T, quote = "")
ecoli_gr <- makeGRangesFromDataFrame(ecoli_df, keep.extra.columns=T)
seqlengths(ecoli_gr) <- ecoli_genome_length
dups_df <- read.table("sim2_dup_60.txt", sep="\t", header=T, quote="")
# calculate double count proportion
dbl_count_table <- table(dups_df$dbl_count)
double_count_percent <- dbl_count_table["TRUE"] * 100 / (dbl_count_table["TRUE"] + dbl_count_table["FALSE"])
# subsample for plotting
set.seed(31456)
sample_rows <- sample(1:nrow(dups_df), nrow(dups_df)*0.1, replace = F)
# prepare
colors = rep("blue", length(dups_df$dbl_count))
colors[dups_df$dbl_count == TRUE] = "red"
dups_df$colors = colors
dedup = rep("blue", length(dups_df$dbl_count))
dedup[dups_df$sofa == TRUE] = "pink"
dups_df$dedup = dedup
dups_df_small = data.frame(chr=dups_df$chr[sample_rows],
start=dups_df$start[sample_rows],
end=dups_df$end[sample_rows],
strand=dups_df$strand[sample_rows],
dbl_count=dups_df$dbl_count[sample_rows],
colors=dups_df$colors[sample_rows],
sofa=dups_df$dedup[sample_rows])
dups_gr_small <- makeGRangesFromDataFrame(dups_df_small, keep.extra.columns=T)
seqlengths(dups_gr_small) <- ecoli_genome_length
p1 <- ggbio()
p1 <- p1 + circle(subset(dups_gr_small, sofa=="pink"), geom = "rect", color="purple")
p1 <- p1 + circle(subset(dups_gr_small, colors=="red"), geom = "rect", color="red")
p1 <- p1 + circle(subset(dups_gr_small, colors=="blue"), geom = "rect", color="blue")
#p1 <- p1 + circle(ecoli_gr, geom = "rect", color = "#7EC658")
p1 <- p1 + circle(ecoli_gr, geom = "ideo", fill = "gray70")
p1 <- p1 + circle(ecoli_gr, geom = "scale", scale.n=10, size = 3)
p1
ecoli_coding_percent <- round(sum(abs(ecoli_df$end - ecoli_df$start)) * 100 / ecoli_genome_length, 1)
ecoli_avg_gene_length <- round(sum(abs(ecoli_df$end - ecoli_df$start)) / length(ecoli_df$start))
sum(abs(dups_df$start-dups_df$end)) / length(dups_df$star)
library(ggbio)
library(GenomicRanges)
ecoli_genome_length = 4641652
ecoli_df <- read.table("data/genomic_ranges/NC_000913.3_CDS_gr.txt", sep="\t", header=T, quote = "")
ecoli_gr <- makeGRangesFromDataFrame(ecoli_df, keep.extra.columns=T)
seqlengths(ecoli_gr) <- ecoli_genome_length
dups_df <- read.table("sim2_dup_60.txt", sep="\t", header=T, quote="")
# calculate double count proportion
dbl_count_table <- table(dups_df$dbl_count)
double_count_percent <- dbl_count_table["TRUE"] * 100 / (dbl_count_table["TRUE"] + dbl_count_table["FALSE"])
# subsample for plotting
set.seed(31456)
sample_rows <- sample(1:nrow(dups_df), nrow(dups_df)*0.1, replace = F)
# prepare
colors = rep("blue", length(dups_df$dbl_count))
colors[dups_df$dbl_count == TRUE] = "red"
dups_df$colors = colors
dedup = rep("blue", length(dups_df$dbl_count))
dedup[dups_df$sofa == TRUE] = "pink"
dups_df$dedup = dedup
dups_df_small = data.frame(chr=dups_df$chr[sample_rows],
start=dups_df$start[sample_rows],
end=dups_df$end[sample_rows],
strand=dups_df$strand[sample_rows],
dbl_count=dups_df$dbl_count[sample_rows],
colors=dups_df$colors[sample_rows],
sofa=dups_df$dedup[sample_rows])
dups_gr_small <- makeGRangesFromDataFrame(dups_df_small, keep.extra.columns=T)
seqlengths(dups_gr_small) <- ecoli_genome_length
p1 <- ggbio()
p1 <- p1 + circle(subset(dups_gr_small, sofa=="pink"), geom = "rect", color="purple")
p1 <- p1 + circle(subset(dups_gr_small, colors=="red"), geom = "rect", color="red")
p1 <- p1 + circle(subset(dups_gr_small, colors=="blue"), geom = "rect", color="blue")
p1 <- p1 + circle(ecoli_gr, geom = "rect", color = "#7EC658")
p1 <- p1 + circle(ecoli_gr, geom = "ideo", fill = "gray70")
p1 <- p1 + circle(ecoli_gr, geom = "scale", scale.n=10, size = 3)
p1
ecoli_coding_percent <- round(sum(abs(ecoli_df$end - ecoli_df$start)) * 100 / ecoli_genome_length, 1)
ecoli_avg_gene_length <- round(sum(abs(ecoli_df$end - ecoli_df$start)) / length(ecoli_df$start))
sum(abs(dups_df$start-dups_df$end)) / length(dups_df$star)
library(ggbio)
library(GenomicRanges)
ecoli_genome_length = 4641652
ecoli_df <- read.table("data/genomic_ranges/NC_000913.3_CDS_gr.txt", sep="\t", header=T, quote = "")
ecoli_gr <- makeGRangesFromDataFrame(ecoli_df, keep.extra.columns=T)
seqlengths(ecoli_gr) <- ecoli_genome_length
dups_df <- read.table("sim2_dup_60.txt", sep="\t", header=T, quote="")
# calculate double count proportion
dbl_count_table <- table(dups_df$dbl_count)
double_count_percent <- dbl_count_table["TRUE"] * 100 / (dbl_count_table["TRUE"] + dbl_count_table["FALSE"])
# subsample for plotting
set.seed(31456)
sample_rows <- sample(1:nrow(dups_df), nrow(dups_df)*0.25, replace = F)
# prepare
colors = rep("blue", length(dups_df$dbl_count))
colors[dups_df$dbl_count == TRUE] = "red"
dups_df$colors = colors
dedup = rep("blue", length(dups_df$dbl_count))
dedup[dups_df$sofa == TRUE] = "pink"
dups_df$dedup = dedup
dups_df_small = data.frame(chr=dups_df$chr[sample_rows],
start=dups_df$start[sample_rows],
end=dups_df$end[sample_rows],
strand=dups_df$strand[sample_rows],
dbl_count=dups_df$dbl_count[sample_rows],
colors=dups_df$colors[sample_rows],
sofa=dups_df$dedup[sample_rows])
dups_gr_small <- makeGRangesFromDataFrame(dups_df_small, keep.extra.columns=T)
seqlengths(dups_gr_small) <- ecoli_genome_length
p1 <- ggbio()
p1 <- p1 + circle(subset(dups_gr_small, sofa=="pink"), geom = "rect", color="purple")
p1 <- p1 + circle(subset(dups_gr_small, colors=="red"), geom = "rect", color="red")
p1 <- p1 + circle(subset(dups_gr_small, colors=="blue"), geom = "rect", color="blue")
p1 <- p1 + circle(ecoli_gr, geom = "rect", color = "#7EC658")
p1 <- p1 + circle(ecoli_gr, geom = "ideo", fill = "gray70")
p1 <- p1 + circle(ecoli_gr, geom = "scale", scale.n=10, size = 3)
p1
ecoli_coding_percent <- round(sum(abs(ecoli_df$end - ecoli_df$start)) * 100 / ecoli_genome_length, 1)
ecoli_avg_gene_length <- round(sum(abs(ecoli_df$end - ecoli_df$start)) / length(ecoli_df$start))
sum(abs(dups_df$start-dups_df$end)) / length(dups_df$star)
